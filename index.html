<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<title>Vision News Clustering</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
body { margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; background:#f5f7fa; color:#1a1a1a; }
header { padding:12px 24px; background:#fff; border-bottom:1px solid #e2e6ec; }
#toolbar { display:flex; flex-wrap:wrap; gap:16px; align-items:center; }
.toolbar-block { display:flex; align-items:center; gap:6px; }
button { cursor:pointer; padding:6px 14px; border:1px solid #2476ff; background:#2476ff; color:#fff; border-radius:4px; font-size:14px; }
button.secondary { background:#fff; color:#2476ff; }
button.danger { background:#d9534f; border-color:#d9534f; }
button:disabled { opacity:.6; cursor: not-allowed; }
input[type=range] { width:180px; }
#clusters { max-width:1280px; margin:28px auto 60px; display:grid; grid-template-columns:repeat(auto-fill,minmax(360px,1fr)); gap:28px; padding:0 24px; }
.cluster-card { background:#fff; border:1px solid #e4e9f1; border-radius:12px; padding:18px 20px 16px; position:relative; display:flex; flex-direction:column; box-shadow:0 2px 4px rgba(0,0,0,.04); }
.cluster-card h3 { margin:0 0 4px; font-size:17px; }
.badge { display:inline-block; padding:2px 6px; border-radius:10px; background:#eef2f8; font-size:12px; margin:0 6px 6px 0; color:#37495f; }
.badge.llm { background:#12b76a; color:#fff; }
.badge.err { background:#e03131; color:#fff; }
.cluster-meta { font-size:12px; color:#6b7785; margin-bottom:10px; }
.sources { margin:8px 0 0; list-style:none; padding:0; max-height:180px; overflow:auto; line-height:1.4; font-size:13px; }
.sources li { margin:4px 0; }
.sources a { text-decoration:none; color:#1456c3; }
.sources a:hover { text-decoration:underline; }
.card-actions { margin-top:10px; display:flex; gap:8px; flex-wrap:wrap; }
.card-actions button { font-size:12px; padding:4px 10px; border-radius:6px; }
#stats { margin-left:auto; font-size:13px; color:#555; white-space:nowrap; }
#llmPanel { background:#fff; border:1px solid #e2e6ec; border-radius:8px; padding:16px 20px 20px; margin:12px 24px 0; max-width:960px; display:none; }
#llmPanel.visible { display:block; }
#llmPanel h4 { margin:0 0 12px; }
.form-row { display:flex; flex-wrap:wrap; gap:12px; margin-bottom:10px; }
.form-row label { font-size:13px; display:flex; flex-direction:column; gap:4px; flex:1 1 200px; }
.form-row input { padding:6px 8px; font-size:13px; border:1px solid #c8d0db; border-radius:4px; width:100%; }
.progress { font-size:12px; color:#444; margin-top:4px; }
.lang-toggle { background:#fff; color:#444; border-color:#ccc; }
footer { text-align:center; font-size:12px; color:#6f7a89; padding:40px 0 80px; }
.small { font-size:12px; color:#7b8794; }
</style>
</head>
<body>
<header>
  <div id="toolbar">
    <div class="toolbar-block">
      <span id="lblThreshold">相似度阈值</span>
      <span id="thresholdValue">(0.88)</span>
      <input id="thresholdInput" type="range" min="0.75" max="0.95" step="0.01" value="0.88" />
    </div>
    <div class="toolbar-block">
      <input id="titleMergeInput" type="checkbox" />
      <label for="titleMergeInput" style="font-size:12px; cursor:pointer;">&gt;0.92 标题二次合并</label>
    </div>
    <button id="btnRecluster">重新聚类</button>
    <button id="btnClearCache" class="secondary">清空缓存</button>
    <button id="btnLLMPanel" class="secondary">LLM 设置面板</button>
    <button id="btnLegacy" class="secondary">Legacy</button>
    <button id="btnLang" class="lang-toggle">中文/EN</button>
    <div id="stats">Raw: 0 &nbsp; Clusters: 0 &nbsp; LLM: 0</div>
  </div>
</header>

<section id="llmPanel">
  <h4>LLM 配置</h4>
  <div class="form-row">
    <label>API Base
      <input id="llmBase" placeholder="https://api.openai.com/v1" />
    </label>
    <label>API Key
      <input id="llmKey" placeholder="sk-..." type="password" />
    </label>
    <label>Model
      <input id="llmModel" placeholder="gpt-4o-mini" />
    </label>
    <label>Batch Size
      <input id="llmBatch" type="number" min="1" max="10" value="4" />
    </label>
  </div>
  <div class="form-row">
    <button id="btnSaveLLM" class="secondary">保存配置</button>
    <button id="btnEnhanceLLM">批量增强未优化集群</button>
    <div id="llmProgress" class="progress"></div>
  </div>
  <div class="small">API Key 仅保存在浏览器 localStorage，不上传服务器。</div>
</section>

<main id="clusters"></main>
<footer>© 2025 Vision News Clustering · Diagnostics: <code>window.__CLUSTER_DIAG__()</code></footer>

<script type="module" src="./app.js"></script>
</body>
</html>
